<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CMS Chiarli - Gestione Contenuti</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      html, body, #root {
        height: 100%;
        font-family: 'Inter', -apple-system, sans-serif;
      }
      ::-webkit-scrollbar {
        width: 6px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: #d6d3d1;
        border-radius: 3px;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
    <script>
      // Global error handler per debugging
      window.addEventListener('error', function(event) {
        console.error('âŒ [Global Error]', event.error);
        console.error('Message:', event.message);
        console.error('Filename:', event.filename);
        console.error('Line:', event.lineno, 'Column:', event.colno);
      });

      window.addEventListener('unhandledrejection', function(event) {
        console.error('âŒ [Unhandled Promise Rejection]', event.reason);
      });

      console.log('ğŸ [HTML] Documento caricato');
      console.log('ğŸ“‹ [HTML] User Agent:', navigator.userAgent);

      // IMPORTANTE: Log URL PRIMA che React si carichi
      console.log('ğŸ”— [HTML] URL al caricamento:', window.location.href);
      console.log('ğŸ”— [HTML] Search params:', window.location.search);
      console.log('ğŸ”— [HTML] bt_token presente:', window.location.search.includes('bt_token'));

      // Salva i params in sessionStorage SUBITO per non perderli
      if (window.location.search.includes('bt_token')) {
        console.log('ğŸ’¾ [HTML] Salvando SSO params in sessionStorage...');
        const params = new URLSearchParams(window.location.search);
        sessionStorage.setItem('sso_bt_token', params.get('bt_token') || '');
        sessionStorage.setItem('sso_bt_connection', params.get('bt_connection') || '');
        console.log('ğŸ’¾ [HTML] Params salvati!');
      }
    </script>
    <script type="module" src="./index.tsx"></script>
  </body>
</html>
